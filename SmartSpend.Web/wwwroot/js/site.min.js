function applyPayee(n){var t=n.data("id");$.ajax({url:"/ajax/tx/applypayee/"+t,type:"POST",beforeSend:xsrf,success:function(t){n.find(".display-category").text(t)},error:function(n,t,i){alert(t+": "+i)}})}function xsrf(n){element=document.getElementById("xsrf");element&&(token=element.value,n.setRequestHeader("RequestVerificationToken",token))}$(document).ready(function(){$(".apply-link").on("click",function(n){n.preventDefault();applyPayee($(this).parents("tr"))});$(".checkbox-post").on("click",function(){$.ajax({url:this.dataset.endpoint,data:{value:$(this).is(":checked")},beforeSend:xsrf,type:"POST",error:function(n,t,i){[401,403].includes(n.status)||alert(t+": "+i)}})});$(".actiondialog").on("show.bs.modal",function(n){var o=$(n.relatedTarget),t=$(this),s=t.find("form"),u=o.parents("tr"),e;s.data("tr",u);var f=u.data("id"),h=t.data("endpoint"),i=t.find(".asp-route-id"),r=i.attr("originalhref");r==null&&(r=i.attr("href"),i.attr("originalhref",r));e=r+"/"+f;i.attr("href",e);$.ajax({url:h+f,success:function(n){t.find(".modal-body").html(n);$(".category-autocomplete").autoComplete({resolverSettings:{url:"/ajax/tx/cat-ac"}})},error:function(n){alert(n.responseText);t.find(".modal-body").text(n.responseText)}})});$(".buttondialog").on("show.bs.modal",function(n){var u=$(n.relatedTarget),f=u.data("id"),i=$(this),r=i.data("endpoint"),t;f!==undefined&&(r=r+"/"+f);t=u.data("method");t===undefined&&(t="GET");$.ajax({url:r,beforeSend:xsrf,type:t,success:function(n){i.find(".modal-body").html(n)},error:function(n){var t=n.responseText;t.length<=0&&(t="Error "+n.status+" "+n.statusText);alert(t);i.find(".modal-body").text(t)}})});$(".iddialog").on("show.bs.modal",function(n){var t=$(n.relatedTarget),i=t.data("id"),r=$(this),u=r.find("form"),f=u.find('input[name="id"]');f.val(i)});$(".partialdialog").on("show.bs.modal",function(){var n=$(this),t=n.data("endpoint");$.ajax({url:t,success:function(t){n.find(".modal-body").html(t)},error:function(t){alert(t.responseText);n.find(".modal-body").text(t.responseText)}})});$("#editModal form").submit(function(n){n.preventDefault();var t=$(this).data("tr"),i=t.data("id");$.ajax({url:"/ajax/tx/edit/"+i,type:"POST",beforeSend:xsrf,data:$(this).serialize(),success:function(n){t.find(".display-payee").text(n.Payee);t.find(".display-memo").text(n.Memo);t.find(".display-category").text(n.Category)},error:function(n,t,i){alert(t+": "+i)}});$(this).parents(".modal").modal("hide")});$("#editPayeeModal form").submit(function(n){n.preventDefault();var t=$(this).data("tr"),i=t.data("id");$.ajax({url:"/ajax/payee/edit/"+i,type:"POST",beforeSend:xsrf,data:$(this).serialize(),success:function(n){t.find(".display-payee").text(n.Name);t.find(".display-category").text(n.Category)},error:function(n,t,i){alert(t+": "+i)}});$(this).parents(".modal").modal("hide")});$("#addPayeeModal form").submit(function(n){n.preventDefault();var t=$(this).data("tr");$.ajax({url:"/ajax/payee/add/",type:"POST",beforeSend:xsrf,data:$(this).serialize(),success:function(){applyPayee(t)},error:function(n,t,i){alert(t+": "+i)}});$(this).parents(".modal").modal("hide")});$("#exportHowModal form").submit(function(){$(this).parents(".modal").modal("hide")});$(".txdrop").on("drop",function(n){var t;if(n.preventDefault(),n.originalEvent.dataTransfer.items){for(t=0;t<n.originalEvent.dataTransfer.items.length;t++)if(n.originalEvent.dataTransfer.items[t].kind==="file"){var u=n.originalEvent.dataTransfer.items[t].getAsFile(),i=$(this),r=i.data("id");let f=new FormData;f.append("file",u);f.append("id",r);$.ajax({url:"/ajax/tx/uprcpt/"+r,type:"POST",beforeSend:xsrf,data:f,processData:!1,contentType:!1,error:function(n){alert(n.responseText)},success:function(){i.find(".display-receipt").children().show();alert("Uploaded successfully.")}})}}else for(t=0;t<ev.dataTransfer.files.length;t++)alert("... file["+t+"].name = "+ev.dataTransfer.files[t].name)});$("a[data-help-topic]").click(function(){var n=$("#helpModal");if(n.length){var t=$(this).data("help-topic"),i=$(this).data("help-href"),r="/Help?id="+t,u=new bootstrap.Modal(n);n.data("endpoint",r);$("#helpModalGoBtn").attr("href",i);u.show()}});$(".btnDismissModal").click(function(){$(this).parentsUntil("#modal").modal("hide")});$(".category-autocomplete").autoComplete({resolverSettings:{url:"/ajax/tx/cat-ac"}});$("input:file").change(function(){$(this).siblings(":submit").prop("disabled",!1)});$("[data-bs-toggle=tooltip]").tooltip();$("[data-tooltip=tooltip]").tooltip();$("[data-tooltip=tooltip]").on("click",function(){$(this).tooltip("hide")})});$(window).on("load",function(){var n=$(".dialog-autoshow"),r,t,i;n.length&&(i=n.data("endpoint"),r=new bootstrap.Modal(n),r.show(),$.ajax({url:i,success:function(t){n.find(".modal-body").html(t)},error:function(t){alert(t.responseText);n.find(".modal-body").text(t.responseText)}}));t=$(".loadr");t.length&&(i=t.data("endpoint"),$.ajax({url:i,success:function(n){t.html(n)},error:function(n){alert(n.responseText);t.html("<p/>")}}))});